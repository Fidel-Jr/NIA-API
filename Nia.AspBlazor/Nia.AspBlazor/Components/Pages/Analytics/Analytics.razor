@page "/analytics"
@rendermode InteractiveServer
@* <h3>Analytics</h3> *@

<main class="h-full pb-16 overflow-y-auto">

    <div class="d-flex justify-content-between align-items-center mb-4" style="padding: 0 !important; margin: 0;">
        <div>
            <h2 class="h4 text-dark" style="padding: 0 !important;">Predictive Analytics Overview</h2>
        </div>

        <div class="d-flex justify-content-end align-items-center">
            <!-- Date Range Picker -->
            <div>
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Gap="0.5rem" class="rz-p-sm-12" Style="padding: 0 10px 0 0 !important;">
                    <RadzenDropDown Placeholder="Last 3 months" @bind-Value=@value Data=@DateRange Style="width: 100%; max-width: 400px;" Name="DropDownBindValue" />
                </RadzenStack>
            </div>
            <div>
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Gap="0.5rem" class="rz-p-sm-12" Style="padding: 0 10px 0 0 !important;">
                    <RadzenDropDown Placeholder="All Categories" @bind-Value=@value Data=@DateRange Style="width: 100%; max-width: 400px;" Name="DropDownBindValue" />
                </RadzenStack>
            </div>
            <div>
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Gap="0.5rem" class="rz-p-sm-12" Style="padding: 0 0 0 0 !important;">
                    <RadzenDropDown Placeholder="All Status" @bind-Value=@value Data=@DateRange Style="width: 100%; max-width: 400px;" Name="DropDownBindValue" />
                </RadzenStack>
            </div>
       
        </div>
    </div>
    <div class="row g-4 mb-4">
        <!-- Total Consumables Card -->
        <div class="col-md-4">
            <div class="card shadow-sm border-0">
                <div class="card-body d-flex align-items-center">
                    <div class="me-3 d-flex align-items-center justify-content-center bg-primary bg-opacity-75 rounded-circle" style="width: 45px; height: 45px;">
                        <span class="material-symbols-outlined" style=" color: white;">
                            deployed_code
                        </span>
                    </div>
                    <div>
                        <p class="text-muted small mb-1">Total Consumables Used</p>
                        <h6 class="mb-0">
                            1,234 Items
                            <RadzenButton Text="View" Link="../notifications/overview2.html" Class="rz-button-sm ms-2" Style="background-color: #4a92ff; color: white;" />
                        </h6>
                    </div>
                </div>
            </div>
        </div>

        <!-- Predicted Usage Card -->
        <div class="col-md-4">
            <div class="card shadow-sm border-0">
                <div class="card-body d-flex align-items-center">
                    <div class="me-3 d-flex align-items-center justify-content-center bg-success bg-opacity-25 rounded-circle" style="width: 45px; height: 45px;">
                        <span class="material-symbols-outlined" style=" color: #00c951;">
                            settings
                        </span>
                    </div>
                    <div>
                        <p class="text-muted small mb-1">Predicted Usage Next Month</p>
                        <h6 class="mb-0">
                            450 units
                            <RadzenButton Text="View" Link="../notifications/overview2.html" Style="background-color: #00c951" Class="rz-button-sm ms-2" />
                        
                        </h6>
                    </div>
                </div>
            </div>
        </div>

        <!-- Maintenance Forecast Card -->
        <div class="col-md-4">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body d-flex align-items-center justify-content-between">
                    <div class="me-3 d-flex align-items-center justify-content-center bg-warning bg-opacity-25 rounded-circle" style="width: 45px; height: 45px;">
                        <span class="material-symbols-outlined" style=" color: #f0b000;">
                            settings
                        </span>
                    </div>
                    <div class="flex-grow-1">
                        <p class="text-muted small mb-1">Maintenance Forecast</p>
                        <div class="d-flex align-items-center" style="height: 30px;"><h6 class="mb-0">12 items</h6></div>
                    </div>
                </div>
            </div>
        </div>
    
    </div>

    <RadzenCard Style="margin-bottom: 20px">
        <div class="row align-items-center">
            <!-- Icon and Text -->
            <div class="col-md-8 d-flex align-items-start gap-3 mb-3 mb-md-0">
                <RadzenIcon Icon="warning" Style="font-size: 24px; color: #f59e0b" />
                <div>
                    <p class="mb-1 fw-semibold">Paper (A4) - Only 12 reams left</p>
                    <p class="mb-1">Ballpens - <span class="fw-bold">Low stock (50 pcs remaining)</span></p>
                    <p class="mb-0 fw-semibold">Flash Drives - Critical (5 pcs remaining)</p>
                </div>
            </div>

            <!-- Buttons -->
            <div class="col-md-4 d-flex justify-content-md-end gap-2">
                <RadzenButton Text="View Inventory" Link="../items.html" Style="background-color: #228c22;" Class="rz-button-sm w-100 w-md-auto" />
                <RadzenButton Text="Restock" Link="../notifications/restock/index.html" ButtonStyle="ButtonStyle.Secondary" Class="rz-button-sm w-100 w-md-auto" />
            </div>
        </div>
    </RadzenCard>

    <div class="row g-4 mb-4">
        <!-- Usage Trends Chart -->
        <div class="col-md-6">
            <RadzenCard Style="height: 100%">
                <p class="mb-3 fw-semibold">Usage Trends</p>
                <RadzenChart Style="height: 250px">
                    <!-- Example Data -->
                    <RadzenAreaSeries Smooth="@smooth" Data="@usageTrendsData" CategoryProperty="Month" ValueProperty="Usage" />
                </RadzenChart>
            </RadzenCard>
        </div>

        <!-- Most Used Items Chart -->
        <div class="col-md-6">
            <RadzenCard Style="height: 100%">
                <p class="mb-3 fw-semibold">Most Frequently Used Items</p>
                <RadzenChart Style="height: 250px">
                    <!-- Example Data -->
                    <RadzenColumnSeries Data="@mostUsedItemsData" CategoryProperty="Item" LineType="LineType.Dashed" ValueProperty="Count" />
                </RadzenChart>
            </RadzenCard>
        </div>
    </div>

    <!-- Detailed Table Section -->
    <div class="card shadow-sm mb-4">

        <!-- Forecast Graph -->
        <RadzenCard>
            <p class="mb-3 fw-semibold">Forecast Projection</p>
            <RadzenChart Style="height: 250px">
                <RadzenLineSeries Data="@forecastData" CategoryProperty="Month" ValueProperty="Forecast" Visible="@showMarkers" />
            </RadzenChart>
        </RadzenCard>


    
    </div>
    <!-- Detailed Table Section -->
    <RadzenDataGrid Data="@stockForecast" TItem="StockForecast" ShowPagingSummary="true" PageSize="5" ShowPagination="true" Responsive="true" Class="mb-4">
        <Columns>
            <RadzenDataGridColumn TItem="StockForecast" Property="ItemName" Title="Item Name" />
            <RadzenDataGridColumn TItem="StockForecast" Property="Category" Title="Category" />
            <RadzenDataGridColumn TItem="StockForecast" Property="CurrentStock" Title="Current Stock" />
            <RadzenDataGridColumn TItem="StockForecast" Property="MonthlyAvgUsage" Title="Monthly Avg Usage" />
            <RadzenDataGridColumn TItem="StockForecast" Property="PredictedShortageDate" Title="Predicted Shortage Date" />
        </Columns>
    </RadzenDataGrid>
       <div class="card-footer d-flex justify-content-between align-items-center">
        <RadzenButton Text="Export CSV" Icon="wrap_text" Style="background-color:limegreen;" />
            <nav>
                <button class="btn btn-outline-secondary btn-sm me-2">Previous</button>
                <button class="btn btn-outline-secondary btn-sm">Next</button>
            </nav>
        </div>


</main>
@code {
    private string? value;
    private List<string> DateRange = new()
    {
        "Last 3 months",
        "Last 6 months",
        "Last year",
        "Custom Range",
        
    };
    bool smooth = true;
    bool showMarkers = true;

    class UsageData { public string Month { get; set; } public int Usage { get; set; } }
    class ItemUsage { public string Item { get; set; } public int Count { get; set; } }
    class ForecastEntry { public string Month { get; set; } public int Forecast { get; set; } }
    class StockForecast
    {
        public string ItemName { get; set; }
        public string Category { get; set; }
        public string CurrentStock { get; set; }
        public string MonthlyAvgUsage { get; set; }
        public string PredictedShortageDate { get; set; }
    }

    List<UsageData> usageTrendsData = new()
  {
    new UsageData { Month = "Apr", Usage = 120 },
    new UsageData { Month = "May", Usage = 150 },
    new UsageData { Month = "Jun", Usage = 170 }
  };

    List<ItemUsage> mostUsedItemsData = new()
  {
    new ItemUsage { Item = "Paper", Count = 90 },
    new ItemUsage { Item = "Ink", Count = 70 },
    new ItemUsage { Item = "USB", Count = 45 }
  };

    List<ForecastEntry> forecastData = new()
  {
    new ForecastEntry { Month = "Jul", Forecast = 200 },
    new ForecastEntry { Month = "Aug", Forecast = 220 },
    new ForecastEntry { Month = "Sep", Forecast = 250 }
  };

    List<StockForecast> stockForecast = new()
  {
    new StockForecast { ItemName = "Printer Ink", Category = "Supply", CurrentStock = "15 units", MonthlyAvgUsage = "8 units", PredictedShortageDate = "July 2025" },
    new StockForecast { ItemName = "Ethernet Cable", Category = "ICT", CurrentStock = "10 pcs", MonthlyAvgUsage = "5 pcs", PredictedShortageDate = "August 2025" }
  };

}
